<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="뒤태지존의 끄적거림">
    <title>Quartz 스케줄러 적용 아키텍처 개선 - 3 - 뒤태지존의 끄적거림</title>
    <meta name="author" content="HomoEfficio">
    <meta name="description" content="뒤태지존의 끄적거림">
    
        <link rel="icon" href="/assets/images/favicon.ico">
    
    
        <link rel="alternative" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="Quartz 스케줄러 적용 아키텍처 개선 - 31편에서는 Quartz 스케줄러 적용 시 변경 주기가 다른 스케줄러 모듈과 작업 클래스 모듈을 분리해서 클린 아키텍처에 다가가는 방법을 알아봤다. 2편에서는 Quartz 작업 클래스 모듈에 의존 관계를 주입하는 방법을 알아봤다. 이렇게 두 개의 고개를 성공적으로 넘었고 마지막으로 @Tranactional 고개가">
<meta name="keywords" content="Java,자바,Quartz,Scheduler,Clean Architecture,Interface Segregation Principle,Dependency Inversion Principle,Isolation,쿼츠,스케줄러,클린 아키텍처,인터페이스 분리 원칙,격리,Dependency Injection,SpringBeanJobFactory,ApplicationContext,ApplicationContextAware,AdaptableJobFactory,AutowireCapableBeanFactory,SchedulerFactoryBean,의존 관계 역전 원칙,의존 관계 주입,Transaction,Transactional,CGLib,Proxy,PlatformTransactionManager,트랜잭션,프록시">
<meta property="og:type" content="blog">
<meta property="og:title" content="Quartz 스케줄러 적용 아키텍처 개선 - 3">
<meta property="og:url" content="http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/index.html">
<meta property="og:site_name" content="뒤태지존의 끄적거림">
<meta property="og:description" content="Quartz 스케줄러 적용 아키텍처 개선 - 31편에서는 Quartz 스케줄러 적용 시 변경 주기가 다른 스케줄러 모듈과 작업 클래스 모듈을 분리해서 클린 아키텍처에 다가가는 방법을 알아봤다. 2편에서는 Quartz 작업 클래스 모듈에 의존 관계를 주입하는 방법을 알아봤다. 이렇게 두 개의 고개를 성공적으로 넘었고 마지막으로 @Tranactional 고개가">
<meta property="og:locale" content="ko">
<meta property="og:image" content="https://i.imgur.com/ulrRfis.png">
<meta property="og:image" content="https://i.imgur.com/J2aMQsK.png">
<meta property="og:image" content="https://i.imgur.com/KOmhtvz.png">
<meta property="og:image" content="https://i.imgur.com/7cVLJTD.png">
<meta property="og:image" content="https://i.imgur.com/e7GF1s6.png">
<meta property="og:image" content="https://i.imgur.com/Vm9NDZf.png">
<meta property="og:image" content="https://i.imgur.com/l0xcJB8.png">
<meta property="og:image" content="https://i.imgur.com/JDciNBU.png">
<meta property="og:image" content="https://i.imgur.com/5RHsMzy.png">
<meta property="og:image" content="https://i.imgur.com/mT6CfNb.png">
<meta property="og:image" content="https://i.imgur.com/dbHHXDv.png">
<meta property="og:updated_time" content="2019-09-29T14:49:23.929Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Quartz 스케줄러 적용 아키텍처 개선 - 3">
<meta name="twitter:description" content="Quartz 스케줄러 적용 아키텍처 개선 - 31편에서는 Quartz 스케줄러 적용 시 변경 주기가 다른 스케줄러 모듈과 작업 클래스 모듈을 분리해서 클린 아키텍처에 다가가는 방법을 알아봤다. 2편에서는 Quartz 작업 클래스 모듈에 의존 관계를 주입하는 방법을 알아봤다. 이렇게 두 개의 고개를 성공적으로 넘었고 마지막으로 @Tranactional 고개가">
<meta name="twitter:image" content="https://i.imgur.com/ulrRfis.png">
    
        <meta rel="publisher" content="https://plus.google.com/+오명운"/>
    
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/30f0244ab86396288cdb62c3591c0c30?s=640"/>
    
    
        <meta property="og:image" content="/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/https:/avatars1.githubusercontent.com/u/5505009?s=200&v=4"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/https://avatars1.githubusercontent.com/u/5505009?s=200&v=4" />
    
    
        <meta property="og:image" content="/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/cover-schedule.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/cover-schedule.jpg" />
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style.min.css">
    <!--STYLES END-->
    
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-79893978-1']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6494847158566766",
    enable_page_level_ads: true
  });
</script>
</head>

    <body>
        <div id="blog">
            <header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">뒤태지존의 끄적거림</a>
    </h1>
    
        <a class="header-right-picture" href="/#about">
            <img class="header-picture" src="https://www.gravatar.com/avatar/30f0244ab86396288cdb62c3591c0c30?s=90"/>
        </a>
    
</header>
            <nav id="sidebar" data-behavior="1">
    
    <div class="sidebar-profile">
        <a href="/#about">
            
            <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/30f0244ab86396288cdb62c3591c0c30?s=90"/>
            
        </a>
        <span class="sidebar-profile-name">HomoEfficio</span>
    </div>
    
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/ 
                    ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">Home</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/all-categories
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                    <span class="sidebar-button-desc">Categories</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/all-tags
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">Tags</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/all-archives
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">Archives</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link st-search-show-outputs"
                    href="#search
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                    <span class="sidebar-button-desc">Search</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="#about
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">About me</span>
                </a>
        </li>
        
    </ul>
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link " href="https://github.com/HomoEfficio" target="_blank">
            
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link " href="mailto:homo.efficio@gmail.com" target="_blank">
            
                    <i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i>
                    <span class="sidebar-button-desc">Mail</span>
                </a>
        </li>
        
    </ul>
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/atom.xml
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                    <span class="sidebar-button-desc">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>
            <div id="main" data-behavior="1">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
        <div class="post-header-cover" style="background-image:url('/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/cover-schedule.jpg');">
            <div class="post-header main-content-wrap">
    
        <h1 class="post-title" itemprop="headline">Quartz 스케줄러 적용 아키텍처 개선 - 3</h1>
    
    <div class="post-meta">
    <time  itemprop="datePublished" content="Sun Sep 29 2019 22:59:33 GMT+0900">
        Sep 29, 2019
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Technique/">Technique</a>


    
</div>
</div>
        </div>
    
    <div class="post-content markdown main-content-wrap" itemprop="articleBody">
        
            <h1 id="Quartz-스케줄러-적용-아키텍처-개선-3"><a href="#Quartz-스케줄러-적용-아키텍처-개선-3" class="headerlink" title="Quartz 스케줄러 적용 아키텍처 개선 - 3"></a>Quartz 스케줄러 적용 아키텍처 개선 - 3</h1><p><a href="https://homoefficio.github.io/2019/09/28/Quartz-스케줄러-적용-아키텍처-개선-1/">1편</a>에서는 Quartz 스케줄러 적용 시 변경 주기가 다른 스케줄러 모듈과 작업 클래스 모듈을 분리해서 클린 아키텍처에 다가가는 방법을 알아봤다.</p>
<p><a href="https://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-2/">2편</a>에서는 Quartz 작업 클래스 모듈에 의존 관계를 주입하는 방법을 알아봤다.</p>
<p>이렇게 두 개의 고개를 성공적으로 넘었고 마지막으로 <code>@Tranactional</code> 고개가 남았다.</p>
<p>먼저 일반적인 상황, 즉 스프링부트 애플리케이션인 스케줄러 모듈에서 <code>@Transactional</code>을 사용하는 간단한 코드를 추가해서 <code>@Transactional</code>의 동작을 확인하고, 작업 클래스 모듈에서 <code>@Tranactional</code>을 사용해보자.</p>
<h1 id="스케줄러-모듈에서의-Transactional-동작-확인"><a href="#스케줄러-모듈에서의-Transactional-동작-확인" class="headerlink" title="스케줄러 모듈에서의 @Transactional 동작 확인"></a>스케줄러 모듈에서의 <code>@Transactional</code> 동작 확인</h1><p><code>@Transactional</code> 동작을 확인하기 위해 스케줄러 모듈에 <code>Member</code> 엔티티와 JPA 리포지토리를 추가한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">Member</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Member</span><span class="params">(String name, String email)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MemberRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Member</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>HelloService</code>에 <code>@Transactional</code>을 사용하는 메서드를 추가한다. 저장 후 일부러 예외를 발생시켜서 롤백되게 한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MemberRepository memberRepository;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"OOO &#123;&#125;.sayHello() executed"</span>, <span class="keyword">this</span>.getClass().getSimpleName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Member <span class="title">saveMember</span><span class="params">(Member member)</span> </span>&#123;</span><br><span class="line">        Member dbMember = memberRepository.save(member);</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span>==<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"테스트를 위해 강제로 발생시킨 예외"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dbMember;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>InitRunner</code>에 다음과 같이 <code>HelloService.saveMember()</code>를 호출하고 예외를 잡아 처리하는 코드를 추가한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InitRunner</span> <span class="keyword">implements</span> <span class="title">CommandLineRunner</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Scheduler scheduler;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RemoteJobClassLoader remoteJobClassLoader;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HelloService helloService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Init Runner executed."</span>);</span><br><span class="line">        JobKey jobKey = JobKey.jobKey(<span class="string">"jobkey1"</span>, <span class="string">"jobgroup1"</span>);</span><br><span class="line">        JobDetail jobDetail = buildJobDetail(jobKey);</span><br><span class="line">        Trigger trigger = buildJobTrigger(jobKey);</span><br><span class="line">        scheduler.scheduleJob(jobDetail, trigger);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 여기!!</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Member dbMember = helloService.saveMember(</span><br><span class="line">                <span class="keyword">new</span> Member(<span class="string">"Homo Efficio"</span>, <span class="string">"homo.efficio@gmail.com"</span>));</span><br><span class="line">            log.info(<span class="string">"TTT 회원 [&#123;&#125;] 추가됨"</span>, dbMember);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">"TTT 회원 추가 중 예외 발생. 메시지: &#123;&#125;"</span>,e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 이하 생략..</span></span><br></pre></td></tr></table></figure>
<p>실행하고 h2 web console로 확인해보면 롤백되어 레코드가 추가되지 않았음을 확인할 수 있다.</p>
<p><img src="https://i.imgur.com/ulrRfis.png" alt="Imgur"></p>
<p><code>HelloService.saveMember()</code>에서 <code>@Transactional</code>을 제거하면 롤백이 실행되지 않으므로 예외가 발생하더라도 레코드가 추가된 채로 남는다.</p>
<p><img src="https://i.imgur.com/J2aMQsK.png" alt="Imgur"></p>
<p>이제 작업 클래스 모듈에서도 <code>@Transactional</code>이 적용되는지 알아보자.</p>
<h1 id="작업-클래스-모듈에서의-Transactional-동작-확인"><a href="#작업-클래스-모듈에서의-Transactional-동작-확인" class="headerlink" title="작업 클래스 모듈에서의 @Transactional 동작 확인"></a>작업 클래스 모듈에서의 <code>@Transactional</code> 동작 확인</h1><p>간단한 확인을 위해 <code>RemoteSimpleJob</code> 클래스에서 직접 <code>MemberRepository</code>를 통해 <code>Member</code>를 저장하는 코드를 작성해보자.</p>
<p>먼저 JPA 리포지토리를 사용할 수 있도록 <code>build.gradle</code>에 다음과 같이 spring-data-jpa-starter를 추가해준다.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile project(<span class="string">':quartz-scheduler'</span>)</span><br><span class="line"></span><br><span class="line">    compileOnly <span class="string">'org.projectlombok:lombok:1.18.8'</span></span><br><span class="line">    annotationProcessor <span class="string">'org.projectlombok:lombok:1.18.8'</span></span><br><span class="line">    compile <span class="string">group:</span> <span class="string">'org.quartz-scheduler'</span>, <span class="string">name:</span> <span class="string">'quartz'</span>, <span class="string">version:</span> <span class="string">'2.3.1'</span></span><br><span class="line">    compile <span class="string">group:</span> <span class="string">'org.springframework'</span>, <span class="string">name:</span> <span class="string">'spring-context-support'</span>, <span class="string">version:</span> <span class="string">'5.1.9.RELEASE'</span></span><br><span class="line">    compile <span class="string">group:</span> <span class="string">'org.springframework.data'</span>, <span class="string">name:</span> <span class="string">'spring-data-jpa'</span>, <span class="string">version:</span> <span class="string">'2.1.10.RELEASE'</span>  <span class="comment">// 여기!!</span></span><br><span class="line"></span><br><span class="line">    testCompile <span class="string">group:</span> <span class="string">'junit'</span>, <span class="string">name:</span> <span class="string">'junit'</span>, <span class="string">version:</span> <span class="string">'4.12'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="RemoteSimpleJob에서-MemberRepository를-통한-Member-저장"><a href="#RemoteSimpleJob에서-MemberRepository를-통한-Member-저장" class="headerlink" title="RemoteSimpleJob에서 MemberRepository를 통한 Member 저장"></a>RemoteSimpleJob에서 MemberRepository를 통한 Member 저장</h2><p><code>RemoteSimpleJob</code>에 <code>MemberRepository</code>를 주입하고 <code>Member</code>를 저장하는 코드를 추가한다. 아직 <code>@Transactional</code>은 추가하지 않은 상태다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteSimpleJob</span> <span class="keyword">implements</span> <span class="title">Job</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HelloService helloService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MemberRepository memberRepository;  <span class="comment">// 여기!!</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(JobExecutionContext context)</span> <span class="keyword">throws</span> JobExecutionException </span>&#123;</span><br><span class="line">        log.info(<span class="string">"OOO REMOTE JOB [&#123;&#125;] executed."</span>, <span class="keyword">this</span>.getClass().getSimpleName());</span><br><span class="line">        JobDataMap mergedJobDataMap = context.getMergedJobDataMap();</span><br><span class="line">        mergedJobDataMap.forEach((k, v) -&gt; log.info(<span class="string">"OOOOO &#123;&#125;: &#123;&#125;"</span>, k, v));</span><br><span class="line"></span><br><span class="line">        helloService.sayHello();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 여기!!</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Member dbMember = memberRepository.save(<span class="keyword">new</span> Member(<span class="string">"Homo Efficio"</span>, <span class="string">"homo.efficio@gmail.com"</span>));</span><br><span class="line">            log.info(<span class="string">"TTT 회원 [&#123;&#125;] 추가됨"</span>, dbMember);</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span>==<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"테스트를 위해 강제로 발생시킨 예외"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">"TTT 회원 추가 중 예외 발생. 메시지: &#123;&#125;"</span>,e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>스케줄러 모듈의 <code>InitRunner</code>에서 <code>HelloService.saveMember()</code> 부분을 다음과 같이 주석처리 한다. 이유는 <code>Member</code> 저장을 <code>RemoteSimpleJob</code> 내에서 처리하기 때문이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Init Runner executed."</span>);</span><br><span class="line">        JobKey jobKey = JobKey.jobKey(<span class="string">"jobkey1"</span>, <span class="string">"jobgroup1"</span>);</span><br><span class="line">        JobDetail jobDetail = buildJobDetail(jobKey);</span><br><span class="line">        Trigger trigger = buildJobTrigger(jobKey);</span><br><span class="line">        scheduler.scheduleJob(jobDetail, trigger);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Member member = new Member("Homo Efficio", "homo.efficio@gmail.com");</span></span><br><span class="line">        <span class="comment">// try &#123;</span></span><br><span class="line">        <span class="comment">//     Member dbMember = helloService.saveMember(member);</span></span><br><span class="line">        <span class="comment">//     log.info("TTT 회원 [&#123;&#125;] 추가됨", dbMember);</span></span><br><span class="line">        <span class="comment">// &#125; catch (Exception e) &#123;</span></span><br><span class="line">        <span class="comment">//     log.error("TTT 회원 추가 중 예외 발생. 메시지: &#123;&#125;",e.getMessage());</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>실행해보면 롤백이 적용되지 않으므로 다음과 같이 저장 후 예외가 발생하더라도 레코드가 추가되는 것을 확인할 수 있다.</p>
<p><img src="https://i.imgur.com/KOmhtvz.png" alt="Imgur"></p>
<p><img src="https://i.imgur.com/7cVLJTD.png" alt="Imgur"></p>
<h2 id="RemoteSimpleJob에서-Transactional-사용"><a href="#RemoteSimpleJob에서-Transactional-사용" class="headerlink" title="RemoteSimpleJob에서 @Transactional 사용"></a>RemoteSimpleJob에서 @Transactional 사용</h2><p>이제 다음과 같이 작업 클래스의 <code>execute()</code> 메서드에 <code>@Transactional</code>을 붙여서 실행해보자.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>  <span class="comment">// 여기!!</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(JobExecutionContext context)</span> <span class="keyword">throws</span> JobExecutionException </span>&#123;</span><br><span class="line">    log.info(<span class="string">"OOO REMOTE JOB [&#123;&#125;] executed."</span>, <span class="keyword">this</span>.getClass().getSimpleName());</span><br><span class="line">    JobDataMap mergedJobDataMap = context.getMergedJobDataMap();</span><br><span class="line">    mergedJobDataMap.forEach((k, v) -&gt; log.info(<span class="string">"OOOOO &#123;&#125;: &#123;&#125;"</span>, k, v));</span><br><span class="line"></span><br><span class="line">    helloService.sayHello();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Member dbMember = memberRepository.save(<span class="keyword">new</span> Member(<span class="string">"Homo Efficio"</span>, <span class="string">"homo.efficio@gmail.com"</span>));</span><br><span class="line">        log.info(<span class="string">"TTT 회원 [&#123;&#125;] 추가됨"</span>, dbMember);</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span>==<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"테스트를 위해 강제로 발생시킨 예외"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">"TTT 회원 추가 중 예외 발생. 메시지: &#123;&#125;"</span>,e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이번에는 안타깝게도 다음과 같은 에러를 만나게 된다. 지면을 많이 차지하니 <a href="https://gist.github.com/HomoEfficio/b2c9e030b785827b5eba75a1e719387d" target="_blank" rel="noopener">지스트(Gist) 링크</a>로 대신하고, 주요 부분만 살펴보면 다음과 같다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">org.quartz.SchedulerException: Job instantiation failed</span><br><span class="line"></span><br><span class="line">Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;io.homo_efficio.quartz.job.RemoteSimpleJob&apos;: Initialization of bean failed; nested exception is org.springframework.aop.framework.AopConfigException: Could not generate CGLIB subclass of class io.homo_efficio.quartz.job.RemoteSimpleJob: Common causes of this problem include using a final class or a non-visible class; nested exception is org.springframework.cglib.core.CodeGenerationException: java.lang.NoClassDefFoundError--&gt;io/homo_efficio/quartz/job/RemoteSimpleJob</span><br><span class="line"></span><br><span class="line">Caused by: org.springframework.aop.framework.AopConfigException: Could not generate CGLIB subclass of class io.homo_efficio.quartz.job.RemoteSimpleJob: Common causes of this problem include using a final class or a non-visible class; nested exception is org.springframework.cglib.core.CodeGenerationException: java.lang.NoClassDefFoundError--&gt;io/homo_efficio/quartz/job/RemoteSimpleJob</span><br><span class="line"></span><br><span class="line">Caused by: org.springframework.cglib.core.CodeGenerationException: java.lang.NoClassDefFoundError--&gt;io/homo_efficio/quartz/job/RemoteSimpleJob</span><br><span class="line"></span><br><span class="line">Caused by: java.lang.NoClassDefFoundError: io/homo_efficio/quartz/job/RemoteSimpleJob</span><br><span class="line"></span><br><span class="line">Caused by: java.lang.ClassNotFoundException: io.homo_efficio.quartz.job.RemoteSimpleJob</span><br></pre></td></tr></table></figure>
<p>긴 내용이지만 요약하면 <code>@Transactional</code> 기능을 추가하기 위해서 <code>RemoteSimpleJob</code>의 프록시 객체를 CGLib 라이브러리를 이용해서 생성해야 하는데, 이때 <code>RemoteSimpleJob</code> 클래스를 찾을 수 없다는 얘기다.</p>
<p><code>@Transactional</code>이 없을 때는 프록시 객체를 만들 필요가 없으므로 <code>RemoteSimpleJob</code>은 우리가 만든 커스텀 클래스로더를 통해 정상적으로 로딩되어 실행된다. 하지만 <strong><code>@Transactional</code>이 붙어서 CGLib을 통해 프록시 객체를 생성할 때는 우리가 만든 커스텀 클래스로더가 사용되지 못하므로 <code>RemoteSimpleJob</code>을 찾지 못하고 위와 같은 에러가 발생하게 된다.</strong> 그림으로 보면 대략 다음과 같다.</p>
<p><img src="https://i.imgur.com/e7GF1s6.png" alt="Imgur"></p>
<p>그럼 CGLib이 사용하는 클래스로더가 <code>RemoteSimpleJob</code>을 로딩할 수 있게 만들면 이 문제도 해결될 것 같다. CGLib는 애플리케이션 구동 환경에서 정해진 클래스로더를 사용하는데 대략 다음과 같다.</p>
<ul>
<li>Standalone Tomcat 환경이면 <code>WebAppClassLoader</code></li>
<li>스프링부트에 내장된 Embedded Tomcat 환경이면 <code>LaunchedURLClassLoader</code></li>
<li>스프링 devtools를 사용하는 로컬 환경이면 <code>RestartClassLoader</code></li>
</ul>
<p>Standalone Tomcat 환경이라면 <code>context.xml</code> 파일에 <code>&lt;Loader&gt;</code> 엘리먼트를 통해 커스텀 클래스로더를 지정할 수 있고, 스프링부트 환경이라면 <code>PropertiesLauncher</code> 클래스와 <code>loader.path</code> 속성으로 클래스로더를 지정할 수 있고, 가장 범용적으로는 manifest 파일에 <code>Class-Path</code>로 로딩할 클래스가 포함된 클래스패스를 지정해주면 된다.</p>
<p>이론적으로는 그런데 실제로는 애플리케이션 구동 환경 자체도 로컬 개발 환경, 서버 환경 모두 다르고, 그에 따라 스프링 내부에서 구동되는 CGLib이 <code>RemoteSimpleJob</code>을 로딩할 수 있게 하려면 스프링 내부에 대한 심도있는 지식이 필요하다. 그걸로 끝나는 게 아니라 <code>RemoteSimpleJob</code>이 참조하는 다른 클래스, 그 클래스가 참조하는 다른 클래스, 그 클래스가 참조하는 다른 클래스… 를 모두 로딩할 수 있어야 한다.</p>
<p>이것저것 시도해보다가 CGLib이 <code>RemoteSimpleJob</code>에 대한 프록시 객체를 생성하게 만드는 데 간신히 성공했다. TRACE 로그로 확인할 수 있었다. (이건 예전에 했던 내용이라 클래스 이름 등은 현재 예제와 좀 다르다 ;;)</p>
<p><img src="https://i.imgur.com/Vm9NDZf.png" alt="Imgur"></p>
<p>그런데 로그를 자세히 보면 <code>&#39;o.s.aop.framework.CglibAopProxy : Unable to apply any optimizations to advised method: [[[@Transactional_붙어있는_메서드]]]&#39;</code> 대략 이런 내용이 찍히고, 실제로도 트랜잭션 롤백이 동작하지 않았다.</p>
<p>더 결정적인 문제도 있는데 이렇게 <strong>스프링이 제공해주는 프록시 생성 로직을 통해 프록시로 등록되면 해당 프록시는 캐시된다는 점이다. 그래서 나중에 <code>RemoteSimpleJob</code>의 내용을 바꿔서 작업 클래스 모듈의 jar 를 새로 생성한 후에 <code>RemoteSimpleJob</code>을 다시 수행해도 새 프록시가 생성되지 않고 기존 내용을 기준으로 생성되어 캐시된 프록시가 사용될 수 있다.</strong> 이러면 작업 클래스 모듈을 분리한 의도가 퇴색되어 버리는 결과가 된다.</p>
<p>이런 모든 문제를 해결하려면 할 수도 있겠지만 나는 이 정도에서 멈추기로 한다. 왜냐하면 <strong>스프링에서는 <code>@Transactional</code>이 아니라도 <code>PlatformTransactionManager</code>를 사용해서 트랜잭션 기능을 추가할 수 있기 때문이다.</strong></p>
<h2 id="PlatformTransactionManager-사용"><a href="#PlatformTransactionManager-사용" class="headerlink" title="PlatformTransactionManager 사용"></a>PlatformTransactionManager 사용</h2><p>다음과 같이 <code>@Transactional</code>을 제거하고 <code>PlatformTransactionManager</code>를 사용하도록 <code>RemoteSimpleJob</code>을 개선한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteSimpleJob</span> <span class="keyword">implements</span> <span class="title">Job</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HelloService helloService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MemberRepository memberRepository;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PlatformTransactionManager transactionManager;  <span class="comment">// 여기!!</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(JobExecutionContext context)</span> <span class="keyword">throws</span> JobExecutionException </span>&#123;</span><br><span class="line">        log.info(<span class="string">"OOO REMOTE JOB [&#123;&#125;] executed."</span>, <span class="keyword">this</span>.getClass().getSimpleName());</span><br><span class="line">        JobDataMap mergedJobDataMap = context.getMergedJobDataMap();</span><br><span class="line">        mergedJobDataMap.forEach((k, v) -&gt; log.info(<span class="string">"OOOOO &#123;&#125;: &#123;&#125;"</span>, k, v));</span><br><span class="line"></span><br><span class="line">        helloService.sayHello();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 여기!!</span></span><br><span class="line">        TransactionStatus status = transactionManager.getTransaction(<span class="keyword">new</span> DefaultTransactionDefinition());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Member dbMember = memberRepository.save(<span class="keyword">new</span> Member(<span class="string">"Homo Efficio"</span>, <span class="string">"homo.efficio@gmail.com"</span>));</span><br><span class="line">            log.info(<span class="string">"TTT 회원 [&#123;&#125;] 추가됨"</span>, dbMember);</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span>==<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"테스트를 위해 강제로 발생시킨 예외"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            transactionManager.commit(status);  <span class="comment">// 여기!!</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">"TTT 회원 추가 중 예외 발생. 메시지: &#123;&#125;"</span>,e.getMessage());</span><br><span class="line">            transactionManager.rollback(status);  <span class="comment">// 여기!!</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>실행해보면 다음과 같이 <code>TTT 회원 [{}] 추가됨</code> 로그는 찍히지만 그 이후 예외가 발생한다.</p>
<p><img src="https://i.imgur.com/l0xcJB8.png" alt="Imgur"></p>
<p>이제 레코드가 생성되지 않은 것을 h2 web console에서 확인하면 트랜잭션 처리 문제도 해결된다!</p>
<p><img src="https://i.imgur.com/JDciNBU.png" alt="Imgur"></p>
<p>오오~ 예상대로 레코드가 생성되지 않았다. 성공!</p>
<p>세 번째 고개인 <code>@Transactional</code>은 넘지는 못 했지만, 돌아가는 길을 찾아냈다.</p>
<h1 id="정리"><a href="#정리" class="headerlink" title="정리"></a>정리</h1><blockquote>
<ul>
<li><p>스프링부트 애플리케이션에서 분리되어 나간 작업 클래스 모듈에서는 <code>@Transactional</code>을 일반적인 경우처럼 쉽게 사용할 수 없다.</p>
</li>
<li><p>이유는 <code>@Transactional</code> 기능을 추가하기 위해서 <code>RemoteSimpleJob</code>의 프록시 객체를 CGLib 라이브러리를 이용해서 생성해야 하는데, 이때 <code>RemoteSimpleJob</code> 클래스를 찾을 수 없기 때문이다.</p>
</li>
<li><p>작업 클래스 모듈에서 <code>@Transactional</code>은 사용할 수 없지만 <code>PlatformTransactionManager</code>를 이용하면 트랜잭션 처리를 할 수 있다.</p>
</li>
</ul>
</blockquote>
<h1 id="시리즈-마무리"><a href="#시리즈-마무리" class="headerlink" title="시리즈 마무리"></a>시리즈 마무리</h1><p>총 3편에 걸쳐 Quartz 적용 아키텍처를 개선하는 과정을 살펴봤다.</p>
<p>이를 통해 <strong>변경 주기가 다른 스케줄러와 작업 클래스를 별도의 모듈로 분리하고, 분리된 모듈에 의존 관계를 주입해서 트랜잭션까지 처리할 수 있는 클린 Quartz 아키텍처를 적용할 수 있게 됐다.</strong></p>
<h2 id="1편-모듈-분리"><a href="#1편-모듈-분리" class="headerlink" title="1편 모듈 분리"></a>1편 모듈 분리</h2><p><a href="https://homoefficio.github.io/2019/09/28/Quartz-스케줄러-적용-아키텍처-개선-1/">1편</a>의 키워드는 <strong>모듈 분리와  <code>URLClassLoader</code></strong></p>
<p><img src="https://i.imgur.com/5RHsMzy.png" alt="Imgur"></p>
<h2 id="2편-의존-관계-주입"><a href="#2편-의존-관계-주입" class="headerlink" title="2편 의존 관계 주입"></a>2편 의존 관계 주입</h2><p><a href="https://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-2/">2편</a>의 키워드는 <strong>의존 관계 주입과 <code>SpringBeanJobFactory</code></strong></p>
<p><img src="https://i.imgur.com/mT6CfNb.png" alt="Imgur"></p>
<h2 id="3편-트랜잭션-처리"><a href="#3편-트랜잭션-처리" class="headerlink" title="3편 트랜잭션 처리"></a>3편 트랜잭션 처리</h2><p><a href="https://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">3편</a>의 키워드는 <strong>트랜잭션 처리와 <code>PlatformTransactionManager</code></strong></p>
<p><img src="https://i.imgur.com/dbHHXDv.png" alt="Imgur"></p>

        
        
            
        
        <hr/>
        <div>
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="크리에이티브 커먼즈 라이선스" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><a href='https://github.com/homoefficio' target='_blank'>HomoEfficio</a>가 작성한 이 저작물은(는) <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">크리에이티브 커먼즈 저작자표시-비영리-동일조건변경허락 4.0 국제 라이선스</a>에 따라 이용할 수 있습니다.
        </div>
    </div>
    <div class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/AdaptableJobFactory/">AdaptableJobFactory</a> <a class="tag tag--primary tag--small t-link" href="/tags/ApplicationContext/">ApplicationContext</a> <a class="tag tag--primary tag--small t-link" href="/tags/ApplicationContextAware/">ApplicationContextAware</a> <a class="tag tag--primary tag--small t-link" href="/tags/AutowireCapableBeanFactory/">AutowireCapableBeanFactory</a> <a class="tag tag--primary tag--small t-link" href="/tags/CGLib/">CGLib</a> <a class="tag tag--primary tag--small t-link" href="/tags/Clean-Architecture/">Clean Architecture</a> <a class="tag tag--primary tag--small t-link" href="/tags/Dependency-Injection/">Dependency Injection</a> <a class="tag tag--primary tag--small t-link" href="/tags/Dependency-Inversion-Principle/">Dependency Inversion Principle</a> <a class="tag tag--primary tag--small t-link" href="/tags/Interface-Segregation-Principle/">Interface Segregation Principle</a> <a class="tag tag--primary tag--small t-link" href="/tags/Isolation/">Isolation</a> <a class="tag tag--primary tag--small t-link" href="/tags/Java/">Java</a> <a class="tag tag--primary tag--small t-link" href="/tags/PlatformTransactionManager/">PlatformTransactionManager</a> <a class="tag tag--primary tag--small t-link" href="/tags/Proxy/">Proxy</a> <a class="tag tag--primary tag--small t-link" href="/tags/Quartz/">Quartz</a> <a class="tag tag--primary tag--small t-link" href="/tags/Scheduler/">Scheduler</a> <a class="tag tag--primary tag--small t-link" href="/tags/SchedulerFactoryBean/">SchedulerFactoryBean</a> <a class="tag tag--primary tag--small t-link" href="/tags/SpringBeanJobFactory/">SpringBeanJobFactory</a> <a class="tag tag--primary tag--small t-link" href="/tags/Transaction/">Transaction</a> <a class="tag tag--primary tag--small t-link" href="/tags/Transactional/">Transactional</a> <a class="tag tag--primary tag--small t-link" href="/tags/격리/">격리</a> <a class="tag tag--primary tag--small t-link" href="/tags/스케줄러/">스케줄러</a> <a class="tag tag--primary tag--small t-link" href="/tags/의존-관계-역전-원칙/">의존 관계 역전 원칙</a> <a class="tag tag--primary tag--small t-link" href="/tags/의존-관계-주입/">의존 관계 주입</a> <a class="tag tag--primary tag--small t-link" href="/tags/인터페이스-분리-원칙/">인터페이스 분리 원칙</a> <a class="tag tag--primary tag--small t-link" href="/tags/자바/">자바</a> <a class="tag tag--primary tag--small t-link" href="/tags/쿼츠/">쿼츠</a> <a class="tag tag--primary tag--small t-link" href="/tags/클린-아키텍처/">클린 아키텍처</a> <a class="tag tag--primary tag--small t-link" href="/tags/트랜잭션/">트랜잭션</a> <a class="tag tag--primary tag--small t-link" href="/tags/프록시/">프록시</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/10/03/Java-Optional-바르게-쓰기/"  data-tooltip="Java Optional 바르게 쓰기">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-2/" data-tooltip="Quartz 스케줄러 적용 아키텍처 개선 - 2">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>
        
            <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 HomoEfficio. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="1">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/10/03/Java-Optional-바르게-쓰기/"  data-tooltip="Java Optional 바르게 쓰기">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-2/" data-tooltip="Quartz 스케줄러 적용 아키텍처 개선 - 2">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>
                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="1">
    <ul class="share-options">
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">
                <i class="fa fa-google-plus"></i><span class="">Share on Google Plus</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">
                <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://homoefficio.github.io/2019/09/29/Quartz-스케줄러-적용-아키텍처-개선-3/">
                <i class="fa fa-twitter"></i><span>Share on Twitter</span>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
            
        </div>
        <div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/30f0244ab86396288cdb62c3591c0c30?s=110"/>
        
            <h4 id="about-card-name">HomoEfficio</h4>
        
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Seoul, Korea.
            </h5>
        
    </div>
</div>
        <div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script.min.js"></script>
<!--SCRIPTS END-->

    <script type="text/javascript">
        var disqus_shortname = 'hanmomhanda';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>



</html>
