<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="뒤태지존의 끄적거림">
    <title>클래스 리터럴, 타입 토큰, 수퍼 타입 토큰 - 뒤태지존의 끄적거림</title>
    <meta name="author" content="HomoEfficio">
    <meta name="description" content="뒤태지존의 끄적거림">
    
        <link rel="icon" href="/assets/images/favicon.ico">
    
    
        <link rel="alternative" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="클래스 리터럴, 타입 토큰, 수퍼 타입 토큰이 글은 토비님의 방송 채널에서 소개해주신 수퍼 타입 토큰에 대한 내용을 바탕으로 Oracle의 리터럴과 런타임 타입 토큰 튜토리얼, 수퍼 타입 토큰 기법의 창시자로 알려진 Neal Gafter의 글과 Jackson에 사용되고 있는 TypeReference 클래스의 소스 코드를 참고로 작성했다.   클래스 리터럴과">
<meta name="keywords" content="Java,자바,Generic Type,Parameterized Type,Type Parameter,Class Literal,Type Token,Super Type Token,Type Safety,TypeReference,ParameterizedTypeReference,제네릭,타입 파라미터,클래스 리터럴,타입 토큰,수퍼 타입 토큰,타입 안전성">
<meta property="og:type" content="blog">
<meta property="og:title" content="클래스 리터럴, 타입 토큰, 수퍼 타입 토큰">
<meta property="og:url" content="http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/index.html">
<meta property="og:site_name" content="뒤태지존의 끄적거림">
<meta property="og:description" content="클래스 리터럴, 타입 토큰, 수퍼 타입 토큰이 글은 토비님의 방송 채널에서 소개해주신 수퍼 타입 토큰에 대한 내용을 바탕으로 Oracle의 리터럴과 런타임 타입 토큰 튜토리얼, 수퍼 타입 토큰 기법의 창시자로 알려진 Neal Gafter의 글과 Jackson에 사용되고 있는 TypeReference 클래스의 소스 코드를 참고로 작성했다.   클래스 리터럴과">
<meta property="og:locale" content="ko">
<meta property="og:updated_time" content="2019-04-28T17:03:55.472Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="클래스 리터럴, 타입 토큰, 수퍼 타입 토큰">
<meta name="twitter:description" content="클래스 리터럴, 타입 토큰, 수퍼 타입 토큰이 글은 토비님의 방송 채널에서 소개해주신 수퍼 타입 토큰에 대한 내용을 바탕으로 Oracle의 리터럴과 런타임 타입 토큰 튜토리얼, 수퍼 타입 토큰 기법의 창시자로 알려진 Neal Gafter의 글과 Jackson에 사용되고 있는 TypeReference 클래스의 소스 코드를 참고로 작성했다.   클래스 리터럴과">
    
        <meta rel="publisher" content="https://plus.google.com/+오명운"/>
    
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/30f0244ab86396288cdb62c3591c0c30?s=640"/>
    
    
        <meta property="og:image" content="/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/http:/image.slidesharecdn.com/javagenerics-121213082104-phpapp01/95/java-generics-a-deep-dive-6-638.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/http://image.slidesharecdn.com/javagenerics-121213082104-phpapp01/95/java-generics-a-deep-dive-6-638.jpg" />
    
    
        <meta property="og:image" content="/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/coverImage-type-reference.png"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/coverImage-type-reference.png" />
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style.min.css">
    <!--STYLES END-->
    
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-79893978-1']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6494847158566766",
    enable_page_level_ads: true
  });
</script>
</head>

    <body>
        <div id="blog">
            <header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">뒤태지존의 끄적거림</a>
    </h1>
    
        <a class="header-right-picture" href="/#about">
            <img class="header-picture" src="https://www.gravatar.com/avatar/30f0244ab86396288cdb62c3591c0c30?s=90"/>
        </a>
    
</header>
            <nav id="sidebar" data-behavior="1">
    
    <div class="sidebar-profile">
        <a href="/#about">
            
            <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/30f0244ab86396288cdb62c3591c0c30?s=90"/>
            
        </a>
        <span class="sidebar-profile-name">HomoEfficio</span>
    </div>
    
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/ 
                    ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">Home</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/all-categories
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                    <span class="sidebar-button-desc">Categories</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/all-tags
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">Tags</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/all-archives
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">Archives</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link st-search-show-outputs"
                    href="#search
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                    <span class="sidebar-button-desc">Search</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="#about
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">About me</span>
                </a>
        </li>
        
    </ul>
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link " href="https://github.com/HomoEfficio" target="_blank">
            
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link " href="mailto:homo.efficio@gmail.com" target="_blank">
            
                    <i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i>
                    <span class="sidebar-button-desc">Mail</span>
                </a>
        </li>
        
    </ul>
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/atom.xml
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                    <span class="sidebar-button-desc">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>
            <div id="main" data-behavior="1">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
        <div class="post-header-cover" style="background-image:url('/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/coverImage-type-reference.png');">
            <div class="post-header main-content-wrap">
    
        <h1 class="post-title" itemprop="headline">클래스 리터럴, 타입 토큰, 수퍼 타입 토큰</h1>
    
    <div class="post-meta">
    <time  itemprop="datePublished" content="Wed Nov 30 2016 02:04:22 GMT+0900">
        Nov 30, 2016
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Technique/">Technique</a>


    
</div>
</div>
        </div>
    
    <div class="post-content markdown main-content-wrap" itemprop="articleBody">
        
            <h1 id="클래스-리터럴-타입-토큰-수퍼-타입-토큰"><a href="#클래스-리터럴-타입-토큰-수퍼-타입-토큰" class="headerlink" title="클래스 리터럴, 타입 토큰, 수퍼 타입 토큰"></a>클래스 리터럴, 타입 토큰, 수퍼 타입 토큰</h1><p>이 글은 <a href="https://gaming.youtube.com/tobyleetv/live" target="_blank" rel="noopener">토비님의 방송 채널</a>에서 소개해주신 <a href="https://www.youtube.com/watch?v=01sdXvZSjcI" target="_blank" rel="noopener">수퍼 타입 토큰</a>에 대한 내용을 바탕으로 <a href="https://docs.oracle.com/javase/tutorial/extra/generics/literals.html" target="_blank" rel="noopener">Oracle의 리터럴과 런타임 타입 토큰 튜토리얼</a>, 수퍼 타입 토큰 기법의 창시자로 알려진 <a href="http://gafter.blogspot.kr/2006/12/super-type-tokens.html" target="_blank" rel="noopener">Neal Gafter의 글</a>과 Jackson에 사용되고 있는 TypeReference 클래스의 소스 코드를 참고로 작성했다.  </p>
<h2 id="클래스-리터럴과-타입-토큰의-의미"><a href="#클래스-리터럴과-타입-토큰의-의미" class="headerlink" title="클래스 리터럴과 타입 토큰의 의미"></a>클래스 리터럴과 타입 토큰의 의미</h2><ul>
<li>클래스 리터럴(Class Literal)은 <code>String.class</code>, <code>Integer.class</code> 등을 말하며, <code>String.class</code>의 타입은 <code>Class&lt;String&gt;</code>, <code>Integer.class</code>의 타입은 <code>Class&lt;Integer&gt;</code>다.</li>
<li>타입 토큰(Type Token)은 쉽게 말해 타입을 나타내는 토큰이며, <strong>클래스 리터럴이 타입 토큰으로서 사용된다</strong>.</li>
<li><code>myMethod(Class&lt;?&gt; clazz)</code> 와 같은 메서드는 타입 토큰을 인자로 받는 메서드이며, <strong><code>method(String.class)</code>로 호출하면, <code>String.class</code>라는 클래스 리터럴을 타입 토큰 파라미터로 <code>myMethod</code>에 전달한다</strong>.</li>
</ul>
<h2 id="타입-토큰은-어디에-쓰나"><a href="#타입-토큰은-어디에-쓰나" class="headerlink" title="타입 토큰은 어디에 쓰나?"></a>타입 토큰은 어디에 쓰나?</h2><p>아하~~ 이거구나! 하고 금방 감이 오는 구체적인 사례로는 아래와 같은 ObjectMapper를 들 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyLittleTelevision mlt = objectMapper.readValue(jsonString, MyLittleTelevision.class);  <span class="comment">// 아하~ 이거~~</span></span><br></pre></td></tr></table></figure>
<p>범용적으로 말하자면 <strong>타입 토큰은 타입 안전성이 필요한 곳에 사용된다</strong>.</p>
<h2 id="타입-안전성-적용-사례-Heterogeneous-Map"><a href="#타입-안전성-적용-사례-Heterogeneous-Map" class="headerlink" title="타입 안전성 적용 사례 - Heterogeneous Map"></a>타입 안전성 적용 사례 - Heterogeneous Map</h2><p>자바5에서 Generic이 나온 이후로 특정 타입을 가지는 Map은 <code>Map&lt;String, String&gt;</code> 같은 식으로 키와 밸류의 타입을 명시적으로 지정해서 타입 안전성을 확보할 수 있는데, 정해진 특정 타입이 아니라 다양한 타입을 지원해야 하는 Heterogeneous Map이 필요하다면 타입 안전성을 확보하기 위해 다른 방법이 필요하다. 이럴 때 타입 토큰을 이용할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeTokenMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">SimpleTypeSafeMap</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">private</span> Map&lt;Class&lt;?&gt;, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(Class&lt;T&gt; k, T v)</span> </span>&#123;</span><br><span class="line">                map.put(k, v);</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">get</span><span class="params">(Class&lt;T&gt; k)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> k.cast(map.get(k));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        SimpleTypeSafeMap simpleTypeSafeMap = <span class="keyword">new</span> SimpleTypeSafeMap();</span><br><span class="line"></span><br><span class="line">        simpleTypeSafeMap.put(String.class, <span class="string">"abcde"</span>);</span><br><span class="line">        simpleTypeSafeMap.put(Integer.class, <span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 타입 토큰을 이용해서 별도의 캐스팅 없이도 타입 안전성이 확보된다.</span></span><br><span class="line">        String v1 = simpleTypeSafeMap.get(String.class);</span><br><span class="line">        Integer v2 = simpleTypeSafeMap.get(Integer.class);</span><br><span class="line"></span><br><span class="line">        System.out.println(v1);</span><br><span class="line">        System.out.println(v2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>앞에서 나온 <code>SimpleTypeSafeMap</code>에는 아쉬운 단점이 있는데, <strong><code>List&lt;String&gt;.class</code>와 같은 형식의 타입 토큰을 사용할 수 없다</strong>는 점이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeTokenMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        SimpleTypeSafeMap simpleTypeSafeMap = <span class="keyword">new</span> SimpleTypeSafeMap();</span><br><span class="line"></span><br><span class="line">        simpleTypeSafeMap.put(String.class, <span class="string">"abcde"</span>);</span><br><span class="line">        simpleTypeSafeMap.put(Integer.class, <span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 타입 토큰을 이용해서 별도의 캐스팅 없이도 안전하다.</span></span><br><span class="line">        String v1 = simpleTypeSafeMap.get(String.class);</span><br><span class="line">        Integer v2 = simpleTypeSafeMap.get(Integer.class);</span><br><span class="line"></span><br><span class="line">        System.out.println(v1);</span><br><span class="line">        System.out.println(v2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 아래와 같은 List&lt;String&gt;.class라는 클래스 리터럴은 언어에서 지원해주지 않으므로 사용 불가!!</span></span><br><span class="line"><span class="comment">//        typeSafeMap.put(List&lt;String&gt;.class, Arrays.asList("a", "b", "c"));</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="수퍼-타입-토큰"><a href="#수퍼-타입-토큰" class="headerlink" title="수퍼 타입 토큰"></a>수퍼 타입 토큰</h2><p>수퍼 타입 토큰은 앞에서 살펴본 것처럼 <strong><code>List&lt;String&gt;.class</code>라는 클래스 리터럴이 존재할 수 없다는 한계를 뛰어넘을 수 있게 해주는 묘수</strong>라고 할 수 있다. Neal Gafter라는 사람이 <a href="http://gafter.blogspot.kr/2006/12/super-type-tokens.html" target="_blank" rel="noopener">http://gafter.blogspot.kr/2006/12/super-type-tokens.html</a> 에서 처음 고안한 방법으로 알려져 있다. 수퍼급의 타입 토큰이 아니라, <strong>수퍼 타입을 토큰으로 사용한다</strong>는 의미다.</p>
<p>수퍼 타입 토큰은 상속과 Reflection을 기발하게 조합해서 <code>List&lt;String&gt;.class</code> 같은, 원래는 사용할 수 없는 클래스 리터럴을 타입 토큰으로 사용하는 것과 같은 효과를 낼 수 있다.</p>
<p>앞에서 클래스 리터럴을 설명할 때, <code>String.class</code>의 타입이 <code>Class&lt;String&gt;</code>이라고 했었다. <code>Class&lt;String&gt;</code>이라는 타입 정보를 <code>String.class</code>라는 클래스 리터럴로 구할 수 있었던 덕분에 타입 안전성을 확보할 수 있었다.</p>
<p><code>List&lt;String&gt;.class</code>도 타입을 구할 수만 있다면 타입 안전성을 확보할 수 있다는 것은 마찬가지다. 다만, <code>Class&lt;String&gt;</code>와는 달리 <code>Class&lt;List&lt;String&gt;&gt;</code>라는 타입은 <code>List&lt;String&gt;.class</code> 같은 클래스 리터럴로 쉽게 구할 수 없다는 점이 다르다. 하지만 <strong>어떻게든 <code>Class&lt;List&lt;String&gt;&gt;</code>라는 타입을 구할 수 있다면, 우리는 타입 안전성을 확보할 수 있다</strong>.</p>
<h3 id="Class-getGenericSuperclass"><a href="#Class-getGenericSuperclass" class="headerlink" title="Class.getGenericSuperclass()"></a>Class.getGenericSuperclass()</h3><p>결론부터 말하면 우리의 구세주는 <code>Class</code>에 들어있는 <strong><code>public Type getGenericSuperclass()</code></strong> 이놈이다.</p>
<p><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#getGenericSuperclass--" target="_blank" rel="noopener">https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#getGenericSuperclass--</a> 의 설명을 요약해보면 다음과 같다.</p>
<blockquote>
<p><code>getGenericSuperclass()</code>는</p>
<ul>
<li>바로 위의 수퍼 클래스의 타입을 반환하며,</li>
<li>바로 위의 수퍼 클래스가 ParameterizedType이면, <strong>실제 타입 파라미터들을 반영한 타입을 반환해야 한다</strong>.</li>
<li>ParameterizedType에 대해서는 별도 문서를 참고하라.</li>
</ul>
</blockquote>
<p>오~ 뭔가 타입 파라미터들을 반영한 타입을 반환한단다. 우리는 <code>Class&lt;List&lt;String&gt;&gt;</code>라는 타입을 어떻게든 구하려고 하고 있었다. 그런데 <strong><code>getGenericSuperclass()</code> 이놈이 뭔가 파라미터 정보를 포함하는 타입을 반환한단다!!</strong></p>
<p>위의 설명을 조금 각색하면 다음과 같다.</p>
<blockquote>
<ul>
<li>어떤 객체 <code>sub</code>의 바로 위의 수퍼 클래스가 <code>List&lt;String&gt;</code>라는 파라미터를 사용하고 있는 ParameterizedType이면, </li>
<li><code>sub.getClass().getGenericSuperclass()</code>는 <strong><code>List&lt;String&gt;</code> 정보가 포함되어 있는 타입을 반환</strong>해야 한다.</li>
</ul>
</blockquote>
<p>앞에서 살펴본 것을 코드로 작성해보면, 다음과 같다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeTokenMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// SimpleTypeSafeMap 부분 생략</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Super</span>&lt;<span class="title">T</span>&gt; </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 수퍼 클래스에 사용되는 파라미터 타입을 이용한다. 그래서 수퍼 타입 토큰.</span></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Sub</span> <span class="keyword">extends</span> <span class="title">Super</span>&lt;<span class="title">List</span>&lt;<span class="title">String</span>&gt;&gt; </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">        Sub sub = <span class="keyword">new</span> Sub();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 파라미터 타입 정보가 포함된 수퍼 클래스의 타입 정보를 구한다.</span></span><br><span class="line">        Type typeOfGenericSuperclass = sub.getClass().getGenericSuperclass();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ~~~$1Super&lt;java.util.List&lt;java.lang.String&gt;&gt; 라고 나온다!!</span></span><br><span class="line">        System.out.println(typeOfGenericSuperclass);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ParameterizedType-getActualTypeArguments"><a href="#ParameterizedType-getActualTypeArguments" class="headerlink" title="ParameterizedType.getActualTypeArguments()"></a>ParameterizedType.getActualTypeArguments()</h3><p>위에 <code>getGenericSuperclass()</code>의 설명을 보면, <strong>수퍼 클래스가 ParameterizedType이면 타입 파라미터를 포함한 정보를 반환해야 한다</strong>고 했으며, ParameterizedType은 별도의 문서를 보라고 했다.</p>
<p><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/reflect/ParameterizedType.html" target="_blank" rel="noopener">ParameterizedType의 API 문서</a> 를 보면 <code>Type[] getActualTypeArgumensts()</code>라는 메서드가 있다. 느낌이 팍 온다.. 앞의 코드를 조금 보완해보자.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeTokenMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// SimpleTypeSafeMap 부분 생략</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Super</span>&lt;<span class="title">T</span>&gt; </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Sub</span> <span class="keyword">extends</span> <span class="title">Super</span>&lt;<span class="title">List</span>&lt;<span class="title">String</span>&gt;&gt; </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">        Sub sub = <span class="keyword">new</span> Sub();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Type typeOfGenericSuperclass = sub.getClass().getGenericSuperclass();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ~~~$1Super&lt;java.util.List&lt;java.lang.String&gt;&gt; 라고 나온다!!</span></span><br><span class="line">        System.out.println(typeOfGenericSuperclass);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 수퍼 클래스가 ParameterizedType 이므로 ParameterizedType으로 캐스팅 가능</span></span><br><span class="line">        <span class="comment">// ParameterizedType의 getActualTypeArguments()으로 실제 타입 파라미터의 정보를 구한다!!</span></span><br><span class="line">        Type actualType = ((ParameterizedType) typeOfGenericSuperclass).getActualTypeArguments()[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 심봤다! java.util.List&lt;java.lang.String&gt;가 나온다!!</span></span><br><span class="line">        System.out.println(actualType);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>오.. 구했다. </p>
<blockquote>
<p>단순한 클래스 리터럴로는 구할 수 없었던 <code>Class&lt;List&lt;String&gt;&gt;</code>라는 타입 정보를,<br>껍데기 뿐이지만 한 없이 아름다운 수퍼 클래스와 위대한 구세주 <code>getGenericSuperclass()</code>, 그리고 <code>getActualTypeArguments()</code>를 이용해서 구했다.</p>
</blockquote>
<p>이제 게임 끝났네..</p>
<h3 id="아줌마-났어요"><a href="#아줌마-났어요" class="headerlink" title="아줌마 났어요~~"></a>아줌마 났어요~~</h3><p>그럼 바로 써보자.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeTokenMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">SimpleTypeSafeMap</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">private</span> Map&lt;Class&lt;?&gt;, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(Class&lt;T&gt; k, T v)</span> </span>&#123;</span><br><span class="line">                map.put(k, v);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">get</span><span class="params">(Class&lt;T&gt; k)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> k.cast(map.get(k));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        SimpleTypeSafeMap simpleTypeSafeMap = <span class="keyword">new</span> SimpleTypeSafeMap();</span><br><span class="line"></span><br><span class="line">        simpleTypeSafeMap.put(String.class, <span class="string">"abcde"</span>);</span><br><span class="line">        simpleTypeSafeMap.put(Integer.class, <span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 타입 토큰을 이용해서 별도의 캐스팅 없이도 안전하다.</span></span><br><span class="line">        String v1 = simpleTypeSafeMap.get(String.class);</span><br><span class="line">        Integer v2 = simpleTypeSafeMap.get(Integer.class);</span><br><span class="line"></span><br><span class="line">        System.out.println(v1);</span><br><span class="line">        System.out.println(v2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 수퍼 타입 토큰을 써보자</span></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Super</span>&lt;<span class="title">T</span>&gt; </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Sub</span> <span class="keyword">extends</span> <span class="title">Super</span>&lt;<span class="title">List</span>&lt;<span class="title">String</span>&gt;&gt; </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">        Sub sub = <span class="keyword">new</span> Sub();</span><br><span class="line"></span><br><span class="line">        Type typeOfGenericSuperclass = sub.getClass().getGenericSuperclass();</span><br><span class="line"></span><br><span class="line">        System.out.println(typeOfGenericSuperclass);</span><br><span class="line"></span><br><span class="line">        Type actualType = ((ParameterizedType) typeOfGenericSuperclass).getActualTypeArguments()[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        System.out.println(actualType);</span><br><span class="line"></span><br><span class="line">        simpleTypeSafeMap.put(actualType, Arrays.asList(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>)); <span class="comment">// 여기서 에러!!</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>나긴 났는데.. 에러가 나네.. ㅋ 실행도 하기 전에 컴파일 에러다 ㅋㅋ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Wrong 1st argument type. Found: &apos;java.lang.reflect.Type&apos;, required: &apos;java.lang.Class&lt;T&gt;&apos; less...</span><br><span class="line"></span><br><span class="line">put(java.lang.Class&lt;T&gt;, T) in SimpleTypeSafeMap cannot be applied to</span><br><span class="line">(java.lang.reflect.Type, java.util.List&lt;T&gt;)</span><br><span class="line"> </span><br><span class="line">reason: no instance(s) of type variable(s) T exist so that Type conforms to Class&lt;T&gt;</span><br></pre></td></tr></table></figure>
<p><code>SimpleTypeSafeMap</code>은 키로 <code>Class&lt;?&gt;</code>을 받는데, <code>java.lang.reflect.Type</code>를 넘겨주면 어쩌냐는 푸념이다.</p>
<p><code>Class&lt;?&gt;</code>만 받을 수 있는 <code>SimpleTypeSafeMap</code>은 이제 퇴장할 때가 된 것 같다. <code>Class&lt;?&gt;</code>보다 더 General한 <code>java.lang.reflect.Type</code> 같은 키도 받을 수 있도록 약간 고도화한 <code>TypeSafeMap</code>을 만날 때가 되었다. </p>
<p>그리고 빈 껍데기 였던 <code>Super&lt;T&gt;</code>도 이름을 <code>TypeReference&lt;T&gt;</code>로 바꾸고 고도화해보자.<br>먼저 <code>Super&lt;T&gt;</code>를 <code>TypeReference&lt;T&gt;</code>로 바꿔보자.</p>
<h3 id="TypeReference"><a href="#TypeReference" class="headerlink" title="TypeReference"></a>TypeReference<t></t></h3><p><code>Super&lt;T&gt;</code>를 <code>TypeReference&lt;T&gt;</code>로 바꾸는 것을 먼저하는 이유는 <code>TypeReference&lt;T&gt;</code>가 가진 정보가 <code>TypeSafeMap</code>의 키로 사용될 것이기 때문이다.</p>
<p>먼저 코드를 보고 설명을 이어가자.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeReference</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Type type;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">TypeReference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Type superClassType = getClass().getGenericSuperclass();</span><br><span class="line">        <span class="keyword">if</span> (!(superClassType <span class="keyword">instanceof</span> ParameterizedType)) &#123;  <span class="comment">// sanity check</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"TypeReference는 항상 실제 타입 파라미터 정보와 함께 생성되어야 합니다."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.type = ((ParameterizedType)superClassType).getActualTypeArguments()[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Type <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>맨 위에서부터 순차적으로 살펴보자.</p>
<h4 id="abstract"><a href="#abstract" class="headerlink" title="abstract"></a>abstract</h4><p><code>TypeReference</code>를 <code>abstract</code>로 선언했는데, 이유는 <strong><code>new TypeReference&lt;List&lt;String&gt;&gt;()</code>이 아니라 항상 <code>new TypeReference&lt;List&lt;String&gt;&gt;() {}</code> 형식으로 생성하기 위해서다</strong>. 왜냐하면, 타입 파라미터 정보를 구하려면 수퍼 타입 토큰을 이용해야 하는데, <strong>수퍼 타입 토큰을 이용하려면 언제나 누군가의 수퍼 클래스로 존재해야 하기 때문</strong>이다.</p>
<p>잘 와닿지 않는다면 앞에서 단순하게 <code>Sub</code>와 <code>Super</code>를 이용했을 때의 코드를 살펴보면 느낌이 올 것이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span>&lt;<span class="title">T</span>&gt; </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub</span> <span class="keyword">extends</span> <span class="title">Super</span>&lt;<span class="title">List</span>&lt;<span class="title">String</span>&gt;&gt; </span>&#123;&#125;</span><br><span class="line">Sub sub = <span class="keyword">new</span> Sub();</span><br><span class="line">Type typeOfGenericSuperclass = sub.getClass().getGenericSuperclass();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 위의 세 줄을 한 줄로 쓰면 아래와 같다.</span></span><br><span class="line">Type typeOfGenericSuperclass = <span class="keyword">new</span> Super&lt;List&lt;String&gt;&gt;()&#123;&#125;.getClass().getGenericSuperclass();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Super를 TypeReference로 바꾸면</span></span><br><span class="line">Type typeOfGenericSuperclass = <span class="keyword">new</span> TypeReference&lt;List&lt;String&gt;&gt;()&#123;&#125;.getClass().getGenericSuperclass();</span><br></pre></td></tr></table></figure>
<h4 id="타입-파라미터-정보를-담는-type"><a href="#타입-파라미터-정보를-담는-type" class="headerlink" title="타입 파라미터 정보를 담는 type"></a>타입 파라미터 정보를 담는 <code>type</code></h4><p>다음은 <code>Type type</code>이라는 인스턴스 변수다. 아래와 같이 생성자를 통해서 타입 파라미터의 타입 정보를 <code>type</code>에 담는다.</p>
<p>그리고 생성자가 항상 타입 파라미터와 함께 사용되도록, <code>ParameterizedType</code>를 이용해서 sanity check를 적용한다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeReference</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Type type;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">TypeReference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Type superClassType = getClass().getGenericSuperclass();</span><br><span class="line">        <span class="keyword">if</span> (!(superClassType <span class="keyword">instanceof</span> ParameterizedType)) &#123;  <span class="comment">// sanity check</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"TypeReference는 항상 실제 타입 파라미터 정보와 함께 생성되어야 합니다."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.type = ((ParameterizedType)superClassType).getActualTypeArguments()[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Type <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>TypeReference</code>는 준비가 되었다. 이제 <code>TypeSafeMap</code> 차례다.</p>
<h3 id="TypeSafeMap"><a href="#TypeSafeMap" class="headerlink" title="TypeSafeMap"></a>TypeSafeMap</h3><h4 id="키의-타입-변경"><a href="#키의-타입-변경" class="headerlink" title="키의 타입 변경"></a>키의 타입 변경</h4><p>먼저 사용했던 <code>SimpleTypeSafeMap</code>은 key로 <code>Class&lt;?&gt;</code> 타입만을 받을 수 있다는 제약 사항 때문에 퇴장했었다. 이를 개선한 <code>TypeSafeMap</code>은 <code>Class&lt;?&gt;</code>보다 더 일반화된 <code>java.lang.reflect.Type</code>을 key로 받는다.</p>
<p>먼저 <code>SimpleTypeSafeMap</code>의 이름을 <code>TypeSafeMap</code>으로 바꾸고, 내부의 <code>map</code>의 key로 사용되는 <code>Class&lt;?&gt;</code> 부분을 <code>Type</code>으로 바꾼다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeSafeMap</span> </span>&#123;</span><br><span class="line">            </span><br><span class="line"><span class="comment">//  private Map&lt;Class&lt;?&gt;, Object&gt; map = new HashMap&lt;&gt;();</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Type, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();  <span class="comment">// key로 사용되던 Class&lt;?&gt; 대신 Type으로 변경</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(Class&lt;T&gt; k, T v)</span> </span>&#123;</span><br><span class="line">        map.put(k, v);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">get</span><span class="params">(Class&lt;T&gt; k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> k.cast(map.get(k));</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="put-의-개선"><a href="#put-의-개선" class="headerlink" title="put()의 개선"></a>put()의 개선</h4><p><code>TypeSafeMap</code>의 <code>put()</code>에는 수퍼 타입을 추출할 수 있는 <code>TypeReference&lt;T&gt;</code>를 key로 받도록 바꾼다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeSafeMap</span> </span>&#123;</span><br><span class="line">            </span><br><span class="line"><span class="comment">//  private Map&lt;Class&lt;?&gt;, Object&gt; map = new HashMap&lt;&gt;();</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Type, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();  <span class="comment">// key로 사용되던 Class&lt;?&gt; 대신 Type으로 변경</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  public &lt;T&gt; void put(Class&lt;T&gt; k, T v) &#123;</span></span><br><span class="line"><span class="comment">//      map.put(k, v);</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(TypeReference&lt;T&gt; k, T v)</span> </span>&#123;  <span class="comment">// 수퍼 타입을 추출할 수 있는 TypeReference&lt;T&gt;를 인자로 받음</span></span><br><span class="line">        map.put(k.getType(), v);  <span class="comment">// key가 Type으로 바뀌었으므로 기존의 k 대신 k.getType()으로 변경</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">get</span><span class="params">(Class&lt;T&gt; k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> k.cast(map.get(k));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="get-의-개선"><a href="#get-의-개선" class="headerlink" title="get()의 개선"></a>get()의 개선</h4><p>key로 사용되는 <code>Type</code> 자리에는 타입 파라미터를 사용하지 않는 <code>String</code> 같은 일반 클래스도 올 수 있고, 타입 파라미터를 사용하는 <code>List&lt;String&gt;</code>같은 <code>ParameterizedType</code>의 클래스도 올 수 있다. 이 두 경우를 모두 처리하기 위해 다음과 같이 <code>get()</code>을 개선한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeSafeMap</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  private Map&lt;Class&lt;?&gt;, Object&gt; map = new HashMap&lt;&gt;();</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Type, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();  <span class="comment">// key로 사용되던 Class&lt;?&gt; 대신 Type으로 변경</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  public &lt;T&gt; void put(Class&lt;T&gt; k, T v) &#123;</span></span><br><span class="line"><span class="comment">//      map.put(k, v);</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(TypeReference&lt;T&gt; k, T v)</span> </span>&#123;  <span class="comment">// 수퍼 타입을 추출할 수 있는 TypeReference&lt;T&gt;를 인자로 받음</span></span><br><span class="line">        map.put(k.getType(), v);  <span class="comment">// key가 Type으로 바뀌었으므로 기존의 k 대신 k.getType()으로 변경</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  public &lt;T&gt; T get(Class&lt;T&gt; k) &#123;</span></span><br><span class="line"><span class="comment">//      return k.cast(map.get(k));</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">get</span><span class="params">(TypeReference&lt;T&gt; k)</span> </span>&#123;  <span class="comment">// key로 TypeReference&lt;T&gt;를 사용하도록 수정</span></span><br><span class="line">        <span class="keyword">if</span> (k.getType() <span class="keyword">instanceof</span> ParameterizedType)</span><br><span class="line">            <span class="keyword">return</span> ((Class&lt;T&gt;)((ParameterizedType)k.getType()).getRawType()).cast(map.get(k.getType()));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> ((Class&lt;T&gt;)k.getType()).cast(map.get(k.getType()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>조금 복잡해 보이지만, <code>ParameterizedType</code>인 경우에는 <code>getRawType()</code>을 이용해서 키에 사용된 타입 파라미터의 타입으로 캐스팅 해주도록 개선한 것 뿐이다.</p>
<p>자, 이제 지금까지 해본 것을 한데 모아 보자.</p>
<h2 id="All-in-One"><a href="#All-in-One" class="headerlink" title="All in One"></a>All in One</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuperTypeTokenMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeReference</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">private</span> Type type;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="title">TypeReference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                Type superClassType = getClass().getGenericSuperclass();</span><br><span class="line">                <span class="keyword">if</span> (!(superClassType <span class="keyword">instanceof</span> ParameterizedType)) &#123;  <span class="comment">// sanity check</span></span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"TypeReference는 항상 실제 타입 파라미터 정보와 함께 생성되어야 합니다."</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.type = ((ParameterizedType)superClassType).getActualTypeArguments()[<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Type <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> type;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">TypeSafeMap</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">private</span> Map&lt;Type, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();  <span class="comment">// key로 사용되던 Class&lt;?&gt; 대신 Type으로 변경</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(TypeReference&lt;T&gt; k, T v)</span> </span>&#123;  <span class="comment">// 수퍼 타입을 추출할 수 있는 TypeReference&lt;T&gt;를 인자로 받음</span></span><br><span class="line">                map.put(k.getType(), v);  <span class="comment">// key가 Type으로 바뀌었으므로 기존의 k 대신 k.getType()으로 변경</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">get</span><span class="params">(TypeReference&lt;T&gt; k)</span> </span>&#123;  <span class="comment">// key로 TypeReference&lt;T&gt;를 사용하도록 수정</span></span><br><span class="line">                <span class="keyword">if</span> (k.getType() <span class="keyword">instanceof</span> ParameterizedType)</span><br><span class="line">                    <span class="keyword">return</span> ((Class&lt;T&gt;)((ParameterizedType)k.getType()).getRawType()).cast(map.get(k.getType()));</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">return</span> ((Class&lt;T&gt;)k.getType()).cast(map.get(k.getType()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// SimpleTypeSafeMap simpleTypeSafeMap = new SimpleTypeSafeMap();</span></span><br><span class="line">        TypeSafeMap typeSafeMap = <span class="keyword">new</span> TypeSafeMap();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// simpleTypeSafeMap.put(String.class, "abcde");</span></span><br><span class="line">        typeSafeMap.put(<span class="keyword">new</span> TypeReference&lt;String&gt;() &#123;&#125;, <span class="string">"abcde"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// simpleTypeSafeMap.put(Integer.class, 123);</span></span><br><span class="line">        typeSafeMap.put(<span class="keyword">new</span> TypeReference&lt;Integer&gt;() &#123;&#125;, <span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 드디어 List&lt;String&gt; 을 쓸 수 있다!!</span></span><br><span class="line">        <span class="comment">// new TypeReference&lt;List&lt;String&gt;&gt;() &#123;&#125;를 사용해서 List&lt;String&gt;.class와 동일한 효과를!!</span></span><br><span class="line">        typeSafeMap.put(<span class="keyword">new</span> TypeReference&lt;List&lt;String&gt;&gt;() &#123;&#125;, Arrays.asList(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// List&lt;List&lt;String&gt;&gt; 처럼 중첩된 ParameterizedType도 사용 가능하다!!</span></span><br><span class="line">        typeSafeMap.put(<span class="keyword">new</span> TypeReference&lt;List&lt;List&lt;String&gt;&gt;&gt;() &#123;&#125;,</span><br><span class="line">                Arrays.asList(Arrays.asList(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>), Arrays.asList(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Map&lt;K, V&gt;도 된다.</span></span><br><span class="line">        Map&lt;String, String&gt; strMap1 = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        strMap1.put(<span class="string">"Key1"</span>, <span class="string">"Value1"</span>);</span><br><span class="line">        strMap1.put(<span class="string">"Key2"</span>, <span class="string">"Value2"</span>);</span><br><span class="line">        typeSafeMap.put(<span class="keyword">new</span> TypeReference&lt;Map&lt;String, String&gt;&gt;() &#123;&#125;, strMap1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 수퍼 타입 토큰을 이용해서 별도의 캐스팅 없이도 안전하다.</span></span><br><span class="line">        <span class="comment">// String v1 = typeSafeMap.get(String.class);</span></span><br><span class="line">        String v1 = typeSafeMap.get(<span class="keyword">new</span> TypeReference&lt;String&gt;() &#123;&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Integer v2 = typeSafeMap.get(Integer.class);</span></span><br><span class="line">        Integer v2 = typeSafeMap.get(<span class="keyword">new</span> TypeReference&lt;Integer&gt;() &#123;&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 바로 이거다!</span></span><br><span class="line">        <span class="comment">// List&lt;String&gt;.class 처럼 언어에서 지원해 주지 않는 클래스 리터럴을 사용하지 않고도</span></span><br><span class="line">        <span class="comment">// List&lt;String&gt;라는 타입을 쓸 수 있게 되었다.</span></span><br><span class="line">        List&lt;String&gt; listString = typeSafeMap.get(<span class="keyword">new</span> TypeReference&lt;List&lt;String&gt;&gt;() &#123;&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// List&lt;List&lt;String&gt;&gt; 처럼 중첩된 ParameterizedType도 사용 가능하다!!</span></span><br><span class="line">        List&lt;List&lt;String&gt;&gt; listListString =</span><br><span class="line">                typeSafeMap.get(<span class="keyword">new</span> TypeReference&lt;List&lt;List&lt;String&gt;&gt;&gt;() &#123;&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Map&lt;K, V&gt;도 된다.</span></span><br><span class="line">        Map&lt;String, String&gt; strMap = typeSafeMap.get(<span class="keyword">new</span> TypeReference&lt;Map&lt;String, String&gt;&gt;() &#123;&#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(v1);</span><br><span class="line">        System.out.println(v2);</span><br><span class="line">        System.out.println(listString);</span><br><span class="line">        System.out.println(listListString);</span><br><span class="line">        System.out.println(strMap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Spring의-ParameterizedTypeReference"><a href="#Spring의-ParameterizedTypeReference" class="headerlink" title="Spring의 ParameterizedTypeReference"></a>Spring의 ParameterizedTypeReference</h2><p>전지전능하신 Spring느님께서는 <code>ParameterizedTypeReference</code>라는 클래스를 우리에게 하사하시었다.</p>
<p><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/ParameterizedTypeReference.html" target="_blank" rel="noopener">http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/ParameterizedTypeReference.html</a></p>
<p>허무하지만 앞에서 알아본 건 걍 공부했다 치고, 실전에서는 앞에서 만든 <code>TypeReference</code> 대신 <code>ParameterizedTypeReference</code>를 사용하자. ㅋㅋ   </p>
<h2 id="정리"><a href="#정리" class="headerlink" title="정리"></a>정리</h2><blockquote>
<ul>
<li>타입 안전성을 확보하려면 타입 정보가 필요하다.</li>
<li>일반적인 클래스의 타입 정보는 <code>String.class</code>, <code>Integer.class</code>와 같은 클래스 리터럴로 쉽게 구할 수 있다.</li>
<li><code>List&lt;String&gt;.class</code> 같은 클래스 리터럴은 언어에서 지원해주지 않으므로 사용할 수 없다.</li>
<li>수퍼 타입 토큰 기법을 사용하면 클래스 리터럴로 쉽게 구할 수 없는, <code>List&lt;String&gt;</code> 형태의 타입 정보를 구할 수 있다.</li>
<li>따라서 <code>List&lt;String&gt;.class</code>라는 클래스 리터럴을 쓸 수 없더라도, <code>List&lt;String&gt;</code>라는 타입을 쓸 수 있어서 타입 안전성을 확보할 수 있다.</li>
<li>수퍼 타입 토큰 기법은 Spring이 <code>ParameterizedTypeReference</code>를 통해 제공해주고 있으므로 써주자. </li>
</ul>
</blockquote>
<h2 id="더-읽을-거리"><a href="#더-읽을-거리" class="headerlink" title="더 읽을 거리"></a>더 읽을 거리</h2><ul>
<li><a href="https://www.youtube.com/watch?v=01sdXvZSjcI" target="_blank" rel="noopener">토비님 방송 - 수퍼 타입 토큰 1</a></li>
<li><a href="https://www.youtube.com/watch?v=y_uGSqpE4So" target="_blank" rel="noopener">토비님 방송 - 수퍼 타입 토큰 2</a></li>
<li><a href="https://docs.oracle.com/javase/tutorial/extra/generics/literals.html" target="_blank" rel="noopener">Oracle의 리터럴과 런타임 타입 토큰 튜토리얼</a></li>
<li><a href="http://gafter.blogspot.kr/2006/12/super-type-tokens.html" target="_blank" rel="noopener">Neal Gafter의 글</a></li>
<li><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/ParameterizedTypeReference.html" target="_blank" rel="noopener">Spring ParameterizedTypeReference</a></li>
</ul>
<h2 id="더-생각할-거리"><a href="#더-생각할-거리" class="headerlink" title="더 생각할 거리"></a>더 생각할 거리</h2><ul>
<li><code>TypeReference&lt;T&gt;</code> 뿐아니라 <code>BiTypeReference&lt;T, U&gt;</code>, <code>TriTypeReference&lt;T, U, V&gt;</code>, … 도 가능할까?</li>
</ul>

        
        
            
        
        <hr/>
        <div>
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="크리에이티브 커먼즈 라이선스" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><a href='https://github.com/homoefficio' target='_blank'>HomoEfficio</a>가 작성한 이 저작물은(는) <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">크리에이티브 커먼즈 저작자표시-비영리-동일조건변경허락 4.0 국제 라이선스</a>에 따라 이용할 수 있습니다.
        </div>
    </div>
    <div class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Class-Literal/">Class Literal</a> <a class="tag tag--primary tag--small t-link" href="/tags/Generic-Type/">Generic Type</a> <a class="tag tag--primary tag--small t-link" href="/tags/Java/">Java</a> <a class="tag tag--primary tag--small t-link" href="/tags/Parameterized-Type/">Parameterized Type</a> <a class="tag tag--primary tag--small t-link" href="/tags/ParameterizedTypeReference/">ParameterizedTypeReference</a> <a class="tag tag--primary tag--small t-link" href="/tags/Super-Type-Token/">Super Type Token</a> <a class="tag tag--primary tag--small t-link" href="/tags/Type-Parameter/">Type Parameter</a> <a class="tag tag--primary tag--small t-link" href="/tags/Type-Safety/">Type Safety</a> <a class="tag tag--primary tag--small t-link" href="/tags/Type-Token/">Type Token</a> <a class="tag tag--primary tag--small t-link" href="/tags/TypeReference/">TypeReference</a> <a class="tag tag--primary tag--small t-link" href="/tags/수퍼-타입-토큰/">수퍼 타입 토큰</a> <a class="tag tag--primary tag--small t-link" href="/tags/자바/">자바</a> <a class="tag tag--primary tag--small t-link" href="/tags/제네릭/">제네릭</a> <a class="tag tag--primary tag--small t-link" href="/tags/클래스-리터럴/">클래스 리터럴</a> <a class="tag tag--primary tag--small t-link" href="/tags/타입-안전성/">타입 안전성</a> <a class="tag tag--primary tag--small t-link" href="/tags/타입-토큰/">타입 토큰</a> <a class="tag tag--primary tag--small t-link" href="/tags/타입-파라미터/">타입 파라미터</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/01/26/토비의-스프링-1장/"  data-tooltip="토비의 스프링 - 1장">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/11/21/Spring에서-JSON에-XSS-방지-처리-하기/" data-tooltip="Spring에서 JSON에 XSS 방지 처리 하기">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>
        
            <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 HomoEfficio. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="1">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/01/26/토비의-스프링-1장/"  data-tooltip="토비의 스프링 - 1장">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/11/21/Spring에서-JSON에-XSS-방지-처리-하기/" data-tooltip="Spring에서 JSON에 XSS 방지 처리 하기">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>
                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="1">
    <ul class="share-options">
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/">
                <i class="fa fa-google-plus"></i><span class="">Share on Google Plus</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/">
                <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://homoefficio.github.io/2016/11/30/클래스-리터럴-타입-토큰-수퍼-타입-토큰/">
                <i class="fa fa-twitter"></i><span>Share on Twitter</span>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
            
        </div>
        <div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/30f0244ab86396288cdb62c3591c0c30?s=110"/>
        
            <h4 id="about-card-name">HomoEfficio</h4>
        
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Seoul, Korea.
            </h5>
        
    </div>
</div>
        <div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script.min.js"></script>
<!--SCRIPTS END-->

    <script type="text/javascript">
        var disqus_shortname = 'hanmomhanda';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>



</html>
